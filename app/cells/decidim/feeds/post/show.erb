<div class="card__grid feeds__feed" data-content="<%= post_category %>">
  <%= cell("decidim/feeds/post_meta", post) %>
  <div class="">
      <% if post.attachments.any? %>
        <div class="attachments">

          <div class="flex flex-col items-center">
            <ul id="galleryItems_<%= post.id %>" class="image-video-list">
              <% post.attachments.select { |a| a.url.match(/\.(jpg|jpeg|png|svg|webp|mp4|webm)$/i) }.each_with_index do |attachment, index| %>
                <li class="<%= attachment.url.match(/\.(mp4|webm)$/i) ? 'video' : 'image' %> <%= 'hidden' unless index.zero? %> aspect-4/3 overflow-hidden rounded-md" data-src="<%= attachment.url %>">
                  <% if attachment.url.match(/\.(mp4|webm)$/i) %>
                    <%= video_tag(attachment.url, class: "video-class object-contain w-full h-full", controls: true, preload: "auto") %>
                  <% else %>
                    <%= image_tag(attachment.url, class: "image-class object-contain w-full h-full", alt: "Image description") %>
                  <% end %>
                </li>
              <% end %>
            </ul>
            <div id="navDots_<%= post.id %>" class="nav-dots flex gap-2 p-2">
              <% post.attachments.select { |a| a.url.match(/\.(jpg|jpeg|png|svg|webp|mp4|webm)$/i) }.each_with_index do |_, index| %>
                <div class="feedGallery_nav_dot cursor-pointer h-2 w-2 rounded-full shadow-<%= index.zero? ? 'feedNotification' : 'feedNotificationInset' %>" role="button" aria-label="Navigate to item <%= index + 1 %>" data-target="galleryItems_<%= post.id %>" data-index="<%= index %>"></div>
              <% end %>
            </div>
          </div>

          <ul class="document-list space-y-2 mt-4">
            <% post.attachments.reject { |a| a.url.match(/\.(jpg|jpeg|png|svg|webp|mp4|webm)$/i) }.each_with_index do |attachment, index| %>
              <li class="<%= index.even? ? 'bg-feeds-formBody' : '' %> py-1 pl-2 pr-4 flex gap-1 items-center">
                 <%= icon "file-2-line" %> <%= link_to File.basename(attachment.url), attachment.url, class: 'text-sm' %>
              </li>
            <% end %>
          </ul>
        </div>
      <% end %>
  </div>
  <div class="card__grid-text">
    <%= post_body %>
  </div>
  <% if post_category == 'survey' %>
    <%= render partial: "decidim/feeds/content_blocks/feeds/survey.html" %>
  <% end %>
  <%= cell("decidim/feeds/post_comment", post) %>
</div>
